
import pandas as pd
import requests
import json
from pathlib import Path

def create_comprehensive_gazetteer(output_dir="output"):
    """Create a comprehensive Australian mining gazetteer and save it to CSV and JSON."""
    

    Path(output_dir).mkdir(parents=True, exist_ok=True)
    

    mining_locations = [
        ("Perth", -31.9505, 115.8605),
        ("Kalgoorlie", -30.7493, 121.4684),
        ("Karratha", -20.7347, 116.8466),
        ("Port Hedland", -20.3167, 118.6167),
        ("Newman", -23.3582, 119.7369),
        ("Geraldton", -28.7774, 114.6147),
        ("Broome", -17.9614, 122.2359),
        ("Esperance", -33.8614, 121.8811),
        ("Marble Bar", -21.1742, 119.7493),
        ("Tom Price", -22.6938, 117.7894),
        ("Paraburdoo", -23.2074, 117.6672),
        ("Pannawonica", -21.6544, 116.4463),
        ("Dampier", -20.6588, 116.7131),
        ("Roebourne", -20.7822, 117.1361),
        ("Wickham", -20.6708, 117.1389),
        ("Onslow", -21.6358, 115.1131),
        ("Carnarvon", -24.8667, 113.6333),
        ("Meekatharra", -26.5928, 118.4889),
        ("Wiluna", -26.5933, 120.2167),
        ("Leinster", -27.8433, 120.6833),
        ("Leonora", -28.8833, 121.3167),
        ("Laverton", -28.6167, 122.4000),
        ("Coolgardie", -30.9500, 121.1667),
        ("Kambalda", -31.1833, 121.6333),
        ("Norseman", -32.1994, 121.7811),
        ("Southern Cross", -31.2333, 119.3167),
        ("Sandstone", -27.9667, 119.2833),
        ("Cue", -27.4333, 117.8833),
        ("Mount Magnet", -28.0667, 117.8500),
        ("Yalgoo", -28.3333, 116.6833),
        ("Morawa", -29.2167, 116.0167),
        ("Three Springs", -29.5333, 115.7167),
        ("Dongara", -29.2594, 114.9319),
        ("Northam", -31.6539, 116.6708),
        ("York", -31.8886, 116.7708),
        ("Narrogin", -32.9333, 117.1833),
        ("Collie", -33.3667, 116.1500),
        ("Bunbury", -33.3269, 115.6369),
        ("Mandurah", -32.5269, 115.7219),
        ("Rockingham", -32.2769, 115.7308),
        ("Fremantle", -32.0556, 115.7450),
        ("Midland", -31.8944, 115.9933),
        ("Joondalup", -31.7452, 115.7664),
        ("Armadale", -32.1486, 116.0108),
        ("Mangaroon", -22.5667, 115.8333),
        ("Star of Mangaroon", -22.5667, 115.8333),
        ("Popeye Mine", -22.5717, 115.8283),
        
        # Queensland - Major mining areas
        ("Brisbane", -27.4698, 153.0251),
        ("Mount Isa", -20.7256, 139.4928),
        ("Townsville", -19.2564, 146.8183),
        ("Mackay", -21.1550, 149.1839),
        ("Rockhampton", -23.3781, 150.5069),
        ("Gladstone", -23.8392, 151.2569),
        ("Cairns", -16.9186, 145.7781),
        ("Toowoomba", -27.5598, 151.9507),
        ("Gold Coast", -28.0167, 153.4000),
        ("Sunshine Coast", -26.6500, 153.0667),
        ("Bundaberg", -24.8661, 152.3489),
        ("Hervey Bay", -25.2986, 152.8553),
        ("Maryborough", -25.5408, 152.7028),
        ("Gympie", -26.1908, 152.6658),
        ("Kingaroy", -26.5408, 151.8353),
        ("Dalby", -27.1828, 151.2658),
        ("Roma", -26.5669, 148.7869),
        ("Charleville", -26.4075, 146.2611),
        ("Longreach", -23.4422, 144.2444),
        ("Emerald", -23.5281, 148.1575),
        ("Clermont", -22.8244, 147.6375),
        ("Moranbah", -22.0019, 148.0456),
        ("Dysart", -22.5881, 148.3517),
        ("Blackwater", -23.5831, 148.8781),
        ("Biloela", -24.4075, 150.5106),
        ("Weipa", -12.6786, 141.8819),
        ("Thursday Island", -10.5839, 142.2147),
        ("Cooktown", -15.4706, 145.2508),
        ("Port Douglas", -16.4839, 145.4644),
        ("Innisfail", -17.5256, 146.0306),
        ("Tully", -17.9333, 145.9167),
        ("Ingham", -18.6489, 146.1614),
        ("Charters Towers", -20.0997, 146.2569),
        ("Bowen", -20.0167, 148.2333),
        ("Proserpine", -20.4006, 148.5806),
        ("Airlie Beach", -20.2706, 148.7156),
        ("Collinsville", -20.5506, 147.8506),
        ("Cloncurry", -20.7067, 140.5067),
        ("Camooweal", -19.9225, 138.1175),
        ("Normanton", -17.6714, 141.0775),
        ("Karumba", -17.4869, 140.8381),
        ("Burketown", -17.7467, 139.5467),
        ("Doomadgee", -17.9406, 138.8225),
        ("Mornington Island", -16.6667, 139.1667),
        ("Bamaga", -10.9006, 142.3906),
        ("Seisia", -10.8667, 142.3333),
        ("Injune", -25.8506, 148.5556),
        ("Taroom", -25.6406, 149.7656),
        ("Wandoan", -26.1256, 149.9706),
        ("Chinchilla", -26.7456, 150.6306),
        ("Miles", -26.6656, 150.1856),
        ("Surat", -27.1506, 149.0706),
        ("St George", -28.0406, 148.5806),
        ("Dirranbandi", -28.5906, 148.2206),
        ("Cunnamulla", -28.0706, 145.6806),
        ("Thargomindah", -27.9906, 143.8206),
        ("Quilpie", -26.6206, 144.2706),
        ("Windorah", -25.4206, 142.6506),
        ("Birdsville", -25.8906, 139.3506),
        ("Bedourie", -24.3506, 139.4606),
        ("Boulia", -22.9106, 139.9006),
        ("Winton", -22.3906, 143.0306),
        ("Hughenden", -20.8506, 144.1906),
        ("Richmond", -20.7306, 143.1406),
        ("Julia Creek", -20.6606, 141.7506),
        ("McKinlay", -21.1506, 141.2906),
        ("Pentland", -20.5006, 145.2006),
        ("Torrens Creek", -20.8006, 145.0006),
        ("Paluma", -19.0006, 146.2006),
        ("Magnetic Island", -19.1506, 146.8506),
        ("Ayr", -19.5756, 147.4056),
        ("Home Hill", -19.6606, 147.4106),
        ("Giru", -19.5106, 147.1106),
        ("Ravenshoe", -17.6106, 145.4906),
        ("Herberton", -17.3856, 145.3856),
        ("Atherton", -17.2656, 145.4756),
        ("Mareeba", -16.9956, 145.4256),
        ("Kuranda", -16.8156, 145.6356),
        ("Mossman", -16.4656, 145.3756),
        ("Daintree", -16.2656, 145.4156),
        ("Cape Tribulation", -16.0856, 145.4656),
        ("Laura", -15.5406, 144.4306),
        ("Coen", -13.9506, 143.1806),
        ("Lockhart River", -12.7906, 143.3006),
        ("Mapoon", -11.9706, 142.0106),
        ("Napranum", -12.6706, 141.9006),
        ("Aurukun", -13.3506, 141.7206),
        ("Kowanyama", -15.4856, 141.7506),
        ("Pormpuraaw", -14.8956, 141.6106),
        ("Edward River", -14.9006, 141.6006),
        ("Wujal Wujal", -16.0006, 145.2006),
        ("Bloomfield", -15.9106, 145.3306),
        ("Ayton", -15.8006, 145.2506),
        ("Rossville", -15.7506, 145.2306),
        ("Helenvale", -15.6506, 145.1906),
        ("Lakeland", -15.5506, 145.1306),
        ("Maytown", -15.4506, 144.9306),
        ("Palmer River", -15.3506, 144.8306),
        ("Palmerville", -15.2506, 144.7306),
        ("Byerstown", -15.1506, 144.6306),
        ("Montalbion", -15.0506, 144.5306),
        ("Wrotham Park", -16.7506, 142.5306),
        ("Chillagoe", -17.1406, 144.5256),
        ("Almaden", -17.3656, 144.2006),
        ("Forsayth", -18.9006, 143.6006),
        ("Georgetown", -18.2906, 143.5506),
        ("Einasleigh", -18.5006, 143.9006),
        ("Croydon", -18.2006, 142.2506),
        ("Blackall", -24.4206, 145.4656),
        ("Tambo", -24.8706, 146.2606),
        ("Augathella", -25.8006, 146.5906),
        ("Morven", -26.4206, 147.1006),
        ("Mitchell", -26.4906, 147.9806),
        ("Mungallala", -26.4906, 147.7506),
        ("Wallumbilla", -26.5906, 149.0306),
        ("Yuleba", -26.7506, 149.2106),
        ("Condamine", -27.0506, 150.1306),
        ("Millmerran", -27.8606, 151.2706),
        ("Goondiwindi", -28.5506, 150.3106),
        ("Inglewood", -28.4156, 151.0806),
        ("Warwick", -28.2206, 152.0306),
        ("Stanthorpe", -28.6556, 151.9306),
        ("Tenterfield", -29.0556, 152.0206),
        ("Casino", -28.8656, 153.0406),
        ("Kyogle", -28.6156, 153.0106),
        ("Murwillumbah", -28.3306, 153.3906),
        ("Tweed Heads", -28.1756, 153.5406),
        ("Coolangatta", -28.1656, 153.5306),
        ("Southport", -27.9656, 153.4106),
        ("Surfers Paradise", -28.0006, 153.4306),
        ("Robina", -28.0756, 153.3806),
        ("Nerang", -28.0006, 153.3306),
        ("Beenleigh", -27.7106, 153.2006),
        ("Logan", -27.6406, 153.1106),
        ("Ipswich", -27.6156, 152.7606),
        ("Gatton", -27.5506, 152.2806),
        ("Laidley", -27.6306, 152.3906),
        ("Boonah", -27.9956, 152.6806),
        ("Beaudesert", -27.9856, 153.0006),
        ("Jimboomba", -27.8356, 153.0306),
        ("Tamborine", -27.9306, 153.1906),
        ("Canungra", -28.0156, 153.1606),
        ("Springbrook", -28.2256, 153.2806),
        ("Lamington", -28.2156, 153.1306),
        ("Binna Burra", -28.1956, 153.1906),
        ("O'Reilly's", -28.2306, 153.1206),
        ("Mount Tamborine", -27.9256, 153.1906),
        ("Eagle Heights", -27.9356, 153.2006),
        ("North Tamborine", -27.9156, 153.1806),
        ("Tamborine Mountain", -27.9256, 153.1906),
        ("Wongawallan", -27.8656, 153.2306),
        ("Ormeau", -27.7756, 153.2606),
        ("Pimpama", -27.7656, 153.2906),
        ("Coomera", -27.8756, 153.3606),
        ("Oxenford", -27.8856, 153.3106),
        ("Helensvale", -27.9056, 153.3306),
        ("Hope Island", -27.8756, 153.3506),
        ("Sanctuary Cove", -27.8656, 153.3606),
        ("Jacobs Well", -27.7756, 153.3506),
        ("Alberton", -27.8256, 153.3206),
        ("Stapylton", -27.7256, 153.2106),
        ("Holmview", -27.7256, 153.0906),
        ("Bahrs Scrub", -27.7156, 153.1206),
        ("Buccan", -27.6956, 153.0806),
        ("Veresdale", -27.9556, 152.9406),
        ("Kooralbyn", -28.0856, 152.7306),
        ("Rathdowney", -28.2356, 152.8706),
        ("Woodenbong", -28.3856, 152.7206),
        ("Legume", -28.4656, 152.6706),
        ("Killarney", -28.2756, 152.3006),
        ("Queen Mary Falls", -28.3356, 152.2306),
        ("Condong", -28.3056, 153.4606),
        ("Tumbulgum", -28.2756, 153.4506),
        ("Chinderah", -28.2456, 153.5306),
        ("Kingscliff", -28.2556, 153.5706),
        ("Casuarina", -28.2756, 153.5606),
        ("Pottsville", -28.3856, 153.5606),
        ("Hastings Point", -28.3656, 153.5706),
        ("Cabarita", -28.3256, 153.5606),
        ("Bogangar", -28.3456, 153.5606),
        ("Cudgen", -28.3056, 153.5706),
        ("Fingal Head", -28.1956, 153.5706),
        ("Point Danger", -28.1756, 153.5506),
        ("Snapper Rocks", -28.1756, 153.5306),
        ("Rainbow Bay", -28.1756, 153.5306),
        ("Greenmount", -28.1856, 153.5306),
        ("Currumbin", -28.1356, 153.4906),
        ("Elanora", -28.1256, 153.4306),
        ("Tugun", -28.1456, 153.4906),
        ("Bilinga", -28.1656, 153.5106),
        ("Kirra", -28.1656, 153.5306),
        ("Burleigh Heads", -28.0956, 153.4506),
        ("Varsity Lakes", -28.0856, 153.4106),
        ("Burleigh Waters", -28.1056, 153.4306),
        ("West Burleigh", -28.1156, 153.4206),
        ("Miami", -28.0756, 153.4306),
        ("Mermaid Beach", -28.0456, 153.4306),
        ("Nobby Beach", -28.0356, 153.4306),
        ("Mermaid Waters", -28.0556, 153.4206),
        ("Broadbeach", -28.0256, 153.4306),
        ("Broadbeach Waters", -28.0356, 153.4206),
        ("Bundall", -28.0056, 153.4106),
        ("Benowa", -28.0156, 153.3906),
        ("Ashmore", -28.0056, 153.3706),
        ("Molendinar", -28.0156, 153.3506),
        ("Carrara", -28.0256, 153.3706),
        ("Merrimac", -28.0356, 153.3706),
        ("Worongary", -28.0456, 153.3506),
        ("Advancetown", -28.0756, 153.3006),
        ("Mudgeeraba", -28.0856, 153.3706),
        ("Bonogin", -28.1156, 153.3906),
        ("Tallebudgera", -28.1356, 153.4406),
        ("Tallebudgera Valley", -28.1456, 153.4006),
        ("Currumbin Valley", -28.1556, 153.4506),
        ("Currumbin Waters", -28.1256, 153.4706),
        ("Natural Bridge", -28.2456, 153.2606),
        ("Purling Brook", -28.2056, 153.2906),
        ("Numinbah Valley", -28.2556, 153.2306),
        ("Chillingham", -28.3256, 153.2706),
        ("Uki", -28.3856, 153.3506),
        ("Stokers Siding", -28.4256, 153.4006),
        ("Dunoon", -28.4856, 153.3206),
        ("Nimbin", -28.5956, 153.2506),
        ("Lismore", -28.8156, 153.2706),
        ("Goonellabah", -28.8256, 153.3106),
        ("Ballina", -28.8656, 153.5606),
        ("Lennox Head", -28.7956, 153.5906),
        ("Alstonville", -28.8456, 153.4406),
        ("Wollongbar", -28.8156, 153.4206),
        ("Bangalow", -28.6856, 153.5206),
        ("Mullumbimby", -28.5556, 153.4906),
        ("Byron Bay", -28.6456, 153.6206),
        ("Suffolk Park", -28.6856, 153.6206),
        ("Broken Head", -28.7256, 153.6306),
        ("Brunswick Heads", -28.5456, 153.5506),
        ("Ocean Shores", -28.5156, 153.5406),
        ("New Brighton", -28.4756, 153.5206),
        ("Billinudgel", -28.4656, 153.5006),
        ("Burringbar", -28.4556, 153.4506),
        ("Crabbes Creek", -28.4456, 153.4106),
        ("Mooball", -28.4256, 153.4906),
        ("Wooyung", -28.3856, 153.5506),
        ("Salt", -28.2956, 153.5506),
        ("Pepper", -28.3156, 153.5406),
        ("Letitia Spit", -28.1756, 153.5806)
    ]

    # Remove duplicates while preserving order
    seen = set()
    unique_locations = []
    for loc in mining_locations:
        if loc[0] not in seen:
            seen.add(loc[0])
            unique_locations.append(loc)
    
    # Create DataFrame
    df = pd.DataFrame(unique_locations, columns=["Location", "Latitude", "Longitude"])
    
    # Add placeholder columns for additional data (can be populated via API or other sources)

    # Optional: Fetch additional data from an API (e.g., Geoscience Australia)
    # Example (commented out as it requires an actual API endpoint):
    """
    for index, row in df.iterrows():
        try:
            response = requests.get(f"https://api.geoscience.gov.au/mining?location={row['Location']}")
            if response.status_code == 200:
                data = response.json()
                df.at[index, 'Type'] = data.get('type', 'Unknown')
                df.at[index, 'Commodity'] = data.get('commodity', 'Unknown')
                df.at[index, 'Status'] = data.get('status', 'Unknown')
        except requests.RequestException as e:
            print(f"Error fetching data for {row['Location']}: {e}")
    """
    
    # Save to CSV
    csv_path = Path(output_dir) / "australian_mining_gazetteer.csv"
    df.to_csv(csv_path, index=False)
    print(f"Gazetteer saved to {csv_path}")
    
    # Save to JSON
    json_path = Path(output_dir) / "australian_mining_gazetteer.json"
    df.to_json(json_path, orient="records", lines=True)
    print(f"Gazetteer saved to {json_path}")
    
    return df

if __name__ == "__main__":
    try:
        gazetteer_df = create_comprehensive_gazetteer()
        print(f"Created gazetteer with {len(gazetteer_df)} unique locations.")
    except Exception as e:
        print(f"Error creating gazetteer: {e}")